2026-01-31 21:16:07 [INFO] root - Logging initialized. Log file: ./bubble_sam3_mask_20260131_211607.log
2026-01-31 21:16:07 [INFO] __main__ - ================================================================================
2026-01-31 21:16:07 [INFO] __main__ - SAM3 Bubble Segmentation Pipeline Started
2026-01-31 21:16:07 [INFO] __main__ - ================================================================================
2026-01-31 21:16:07 [INFO] __main__ - Input image: img6001.png
2026-01-31 21:16:07 [INFO] __main__ - Output path: imag6001_mask.png
2026-01-31 21:16:07 [INFO] __main__ - Config file: config.json
2026-01-31 21:16:07 [INFO] __main__ - Device: default
2026-01-31 21:16:07 [INFO] __main__ - Loading configuration...
2026-01-31 21:16:07 [DEBUG] __main__ - Configuration: {
  "device": "cuda",
  "seed": 0,
  "sam": {
    "backend": "tracker",
    "model_name": "facebook/sam3",
    "confidence_threshold": 0.4,
    "use_fp16": true,
    "points_per_batch": 128,
    "multimask_output": false
  },
  "preprocess": {
    "enable_contrast_norm": true,
    "contrast_method": "clahe",
    "clahe_clip_limit": 0.03,
    "clahe_kernel_size": 64,
    "rescale_percentiles": [
      2,
      98
    ],
    "gamma": 1.0,
    "invert_gray": false
  },
  "candidates": {
    "enable_candidates": true,
    "method": "log+dog",
    "min_diameter_px": 10,
    "max_diameter_px": 200,
    "log_min_sigma": null,
    "log_max_sigma": null,
    "log_num_sigma": 10,
    "log_threshold": 0.02,
    "dog_min_sigma": null,
    "dog_max_sigma": null,
    "dog_sigma_ratio": 1.6,
    "dog_threshold": 0.02,
    "hough_dp": 1.2,
    "hough_minDist": 8,
    "hough_param1": 100,
    "hough_param2": 30,
    "hough_minRadius": null,
    "hough_maxRadius": null,
    "max_candidates_per_image": 2000,
    "dedup_centers": true,
    "dedup_radius_px": 4.0,
    "fallback_on_empty_candidates": true
  },
  "tiling": {
    "enable_tiling": true,
    "tile_size": 256,
    "tile_h": null,
    "tile_w": null,
    "tile_overlap": 64,
    "pad_mode": "reflect",
    "min_coverage_for_keep": 0.5
  },
  "hole_fill": {
    "enable_hole_fill": true,
    "hole_fill_method": "binary_fill_holes",
    "closing_radius": 2,
    "min_hole_area_px": 0,
    "fill_only_if_ringlike": false,
    "ringlike_threshold": 0.15
  },
  "postprocess": {
    "enable_consolidation": true,
    "iou_dedup_thresh": 0.5,
    "containment_thresh": 0.9,
    "min_area_px": 60,
    "max_area_fraction": 0.2,
    "border_exclusion_px": 1,
    "circularity_min": 0.0,
    "solidity_min": 0.0,
    "enable_convex_hull": false
  },
  "fallback": {
    "mode": "grid",
    "grid_spacing_px": 24,
    "grid_jitter_px": 0,
    "max_points": 4096
  },
  "output": {
    "output_mode": "cutout",
    "overlay_alpha": 128,
    "overlay_colormap": "tab20",
    "write_json": true,
    "json_path": null,
    "write_csv": false,
    "csv_path": null,
    "include_rle": false
  },
  "debug": {
    "debug_dir": null
  }
}
2026-01-31 21:16:07 [INFO] __main__ - Setting random seed to 0
2026-01-31 21:16:07 [INFO] __main__ - Loading image from img6001.png
2026-01-31 21:16:07 [DEBUG] PIL.PngImagePlugin - STREAM b'IHDR' 16 13
2026-01-31 21:16:07 [DEBUG] PIL.PngImagePlugin - STREAM b'IDAT' 41 8192
2026-01-31 21:16:07 [INFO] __main__ - Image size: (1024, 1024)
2026-01-31 21:16:07 [INFO] __main__ - Loading SAM3 tracker model on cuda...
2026-01-31 21:16:24 [DEBUG] httpcore.connection - connect_tcp.started host='huggingface.co' port=443 local_address=None timeout=10 socket_options=None
2026-01-31 21:16:24 [DEBUG] httpcore.connection - connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x7f0cf058d8e0>
2026-01-31 21:16:24 [DEBUG] httpcore.connection - start_tls.started ssl_context=<ssl.SSLContext object at 0x7f0cf0005bd0> server_hostname='huggingface.co' timeout=10
2026-01-31 21:16:24 [DEBUG] httpcore.connection - start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x7f0cf1e8c200>
2026-01-31 21:16:24 [DEBUG] httpcore.http11 - send_request_headers.started request=<Request [b'GET']>
2026-01-31 21:16:24 [DEBUG] httpcore.http11 - send_request_headers.complete
2026-01-31 21:16:24 [DEBUG] httpcore.http11 - send_request_body.started request=<Request [b'GET']>
2026-01-31 21:16:24 [DEBUG] httpcore.http11 - send_request_body.complete
2026-01-31 21:16:24 [DEBUG] httpcore.http11 - receive_response_headers.started request=<Request [b'GET']>
2026-01-31 21:16:24 [DEBUG] httpcore.http11 - receive_response_headers.complete return_value=(b'HTTP/1.1', 404, b'Not Found', [(b'Content-Type', b'application/json; charset=utf-8'), (b'Content-Length', b'64'), (b'Connection', b'keep-alive'), (b'Date', b'Sun, 01 Feb 2026 02:16:24 GMT'), (b'ETag', b'W/"40-09f9IAqP13xarAhQxFS2W8rvRkM"'), (b'X-Powered-By', b'huggingface-moon'), (b'X-Request-Id', b'Root=1-697eb778-4629a2e80a2cdc7a3cfbd407;e1fa0049-e299-4212-b425-3df57bb59153'), (b'RateLimit', b'"api";r=999;t=219'), (b'RateLimit-Policy', b'"fixed window";"api";q=1000;w=300'), (b'cross-origin-opener-policy', b'same-origin'), (b'Referrer-Policy', b'strict-origin-when-cross-origin'), (b'Access-Control-Max-Age', b'86400'), (b'Access-Control-Allow-Origin', b'https://huggingface.co'), (b'Vary', b'Origin'), (b'Access-Control-Expose-Headers', b'X-Repo-Commit,X-Request-Id,X-Error-Code,X-Error-Message,X-Total-Count,ETag,Link,Accept-Ranges,Content-Range,X-Linked-Size,X-Linked-ETag,X-Xet-Hash'), (b'X-Error-Code', b'EntryNotFound'), (b'X-Error-Message', b'additional_chat_templates does not exist on "main"'), (b'X-Cache', b'Error from cloudfront'), (b'Via', b'1.1 96514100085c5a3055b3debbca21d95c.cloudfront.net (CloudFront)'), (b'X-Amz-Cf-Pop', b'JFK50-P9'), (b'X-Amz-Cf-Id', b'QP9-h9ZsP59qj4BEZvd2QR8KxqD6B4SLFWvq9WOvA70f1U_bsNJqBg==')])
2026-01-31 21:16:24 [INFO] httpx - HTTP Request: GET https://huggingface.co/api/models/facebook/sam3/tree/main/additional_chat_templates?recursive=false&expand=false "HTTP/1.1 404 Not Found"
2026-01-31 21:16:24 [DEBUG] httpcore.http11 - receive_response_body.started request=<Request [b'GET']>
2026-01-31 21:16:24 [DEBUG] httpcore.http11 - receive_response_body.complete
2026-01-31 21:16:24 [DEBUG] httpcore.http11 - response_closed.started
2026-01-31 21:16:24 [DEBUG] httpcore.http11 - response_closed.complete
2026-01-31 21:16:24 [DEBUG] httpcore.http11 - send_request_headers.started request=<Request [b'HEAD']>
2026-01-31 21:16:24 [DEBUG] httpcore.http11 - send_request_headers.complete
2026-01-31 21:16:24 [DEBUG] httpcore.http11 - send_request_body.started request=<Request [b'HEAD']>
2026-01-31 21:16:24 [DEBUG] httpcore.http11 - send_request_body.complete
2026-01-31 21:16:24 [DEBUG] httpcore.http11 - receive_response_headers.started request=<Request [b'HEAD']>
2026-01-31 21:16:24 [DEBUG] httpcore.http11 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Content-Type', b'text/plain; charset=utf-8'), (b'Content-Length', b'1712'), (b'Connection', b'keep-alive'), (b'Date', b'Sun, 01 Feb 2026 02:16:24 GMT'), (b'ETag', b'"9d3bd6df8a54852cd56087a3ae019cce051de2b2"'), (b'X-Powered-By', b'huggingface-moon'), (b'X-Request-Id', b'Root=1-697eb778-4814706202db7ee812d87149;dc4dd7b3-9dda-4018-8bac-78d4b79da653'), (b'RateLimit', b'"resolvers";r=4999;t=219'), (b'RateLimit-Policy', b'"fixed window";"resolvers";q=5000;w=300'), (b'cross-origin-opener-policy', b'same-origin'), (b'Referrer-Policy', b'strict-origin-when-cross-origin'), (b'Access-Control-Max-Age', b'86400'), (b'Access-Control-Allow-Origin', b'https://huggingface.co'), (b'Vary', b'Origin'), (b'Access-Control-Expose-Headers', b'X-Repo-Commit,X-Request-Id,X-Error-Code,X-Error-Message,X-Total-Count,ETag,Link,Accept-Ranges,Content-Range,X-Linked-Size,X-Linked-ETag,X-Xet-Hash'), (b'X-Repo-Commit', b'3c879f39826c281e95690f02c7821c4de09afae7'), (b'Accept-Ranges', b'bytes'), (b'X-Hub-Cache', b'HIT'), (b'Content-Disposition', b'inline; filename*=UTF-8\'\'processor_config.json; filename="processor_config.json";'), (b'Content-Security-Policy', b"default-src 'none'; sandbox"), (b'X-Cache', b'Miss from cloudfront'), (b'Via', b'1.1 96514100085c5a3055b3debbca21d95c.cloudfront.net (CloudFront)'), (b'X-Amz-Cf-Pop', b'JFK50-P9'), (b'X-Amz-Cf-Id', b'4vkMhX1l4rttyOms6i3beA9gpVSm3N-OUJQgpsCMRNGNyAb1ZNYPXA==')])
2026-01-31 21:16:24 [INFO] httpx - HTTP Request: HEAD https://huggingface.co/facebook/sam3/resolve/main/processor_config.json "HTTP/1.1 200 OK"
2026-01-31 21:16:24 [DEBUG] httpcore.http11 - receive_response_body.started request=<Request [b'HEAD']>
2026-01-31 21:16:24 [DEBUG] httpcore.http11 - receive_response_body.complete
2026-01-31 21:16:24 [DEBUG] httpcore.http11 - response_closed.started
2026-01-31 21:16:24 [DEBUG] httpcore.http11 - response_closed.complete
2026-01-31 21:16:24 [DEBUG] httpcore.http11 - send_request_headers.started request=<Request [b'HEAD']>
2026-01-31 21:16:24 [DEBUG] httpcore.http11 - send_request_headers.complete
2026-01-31 21:16:24 [DEBUG] httpcore.http11 - send_request_body.started request=<Request [b'HEAD']>
2026-01-31 21:16:24 [DEBUG] httpcore.http11 - send_request_body.complete
2026-01-31 21:16:24 [DEBUG] httpcore.http11 - receive_response_headers.started request=<Request [b'HEAD']>
2026-01-31 21:16:24 [DEBUG] httpcore.http11 - receive_response_headers.complete return_value=(b'HTTP/1.1', 404, b'Not Found', [(b'Content-Type', b'text/plain; charset=utf-8'), (b'Content-Length', b'15'), (b'Connection', b'keep-alive'), (b'Date', b'Sun, 01 Feb 2026 02:16:24 GMT'), (b'ETag', b'W/"f-mY2VvLxuxB7KhsoOdQTlMTccuAQ"'), (b'X-Powered-By', b'huggingface-moon'), (b'X-Request-Id', b'Root=1-697eb778-01b793fa506e864f2d516ef0;af6e12f1-9ec3-400b-b531-60af018f9555'), (b'RateLimit', b'"resolvers";r=4998;t=219'), (b'RateLimit-Policy', b'"fixed window";"resolvers";q=5000;w=300'), (b'cross-origin-opener-policy', b'same-origin'), (b'Referrer-Policy', b'strict-origin-when-cross-origin'), (b'Access-Control-Max-Age', b'86400'), (b'Access-Control-Allow-Origin', b'https://huggingface.co'), (b'Vary', b'Origin'), (b'Access-Control-Expose-Headers', b'X-Repo-Commit,X-Request-Id,X-Error-Code,X-Error-Message,X-Total-Count,ETag,Link,Accept-Ranges,Content-Range,X-Linked-Size,X-Linked-ETag,X-Xet-Hash'), (b'X-Repo-Commit', b'3c879f39826c281e95690f02c7821c4de09afae7'), (b'Accept-Ranges', b'bytes'), (b'X-Hub-Cache', b'MISS'), (b'X-Error-Code', b'EntryNotFound'), (b'X-Error-Message', b'Entry not found'), (b'X-Cache', b'Error from cloudfront'), (b'Via', b'1.1 96514100085c5a3055b3debbca21d95c.cloudfront.net (CloudFront)'), (b'X-Amz-Cf-Pop', b'JFK50-P9'), (b'X-Amz-Cf-Id', b'c_4skp7LebA5zDle3YruZklS4L6nQj-bVcHVq3tmBQ1DQylQsPUKEw==')])
2026-01-31 21:16:24 [INFO] httpx - HTTP Request: HEAD https://huggingface.co/facebook/sam3/resolve/main/chat_template.json "HTTP/1.1 404 Not Found"
2026-01-31 21:16:24 [DEBUG] httpcore.http11 - receive_response_body.started request=<Request [b'HEAD']>
2026-01-31 21:16:24 [DEBUG] httpcore.http11 - receive_response_body.complete
2026-01-31 21:16:24 [DEBUG] httpcore.http11 - response_closed.started
2026-01-31 21:16:24 [DEBUG] httpcore.http11 - response_closed.complete
2026-01-31 21:16:24 [DEBUG] httpcore.http11 - send_request_headers.started request=<Request [b'HEAD']>
2026-01-31 21:16:24 [DEBUG] httpcore.http11 - send_request_headers.complete
2026-01-31 21:16:24 [DEBUG] httpcore.http11 - send_request_body.started request=<Request [b'HEAD']>
2026-01-31 21:16:24 [DEBUG] httpcore.http11 - send_request_body.complete
2026-01-31 21:16:24 [DEBUG] httpcore.http11 - receive_response_headers.started request=<Request [b'HEAD']>
2026-01-31 21:16:24 [DEBUG] httpcore.http11 - receive_response_headers.complete return_value=(b'HTTP/1.1', 404, b'Not Found', [(b'Content-Type', b'text/plain; charset=utf-8'), (b'Content-Length', b'15'), (b'Connection', b'keep-alive'), (b'Date', b'Sun, 01 Feb 2026 02:16:24 GMT'), (b'ETag', b'W/"f-mY2VvLxuxB7KhsoOdQTlMTccuAQ"'), (b'X-Powered-By', b'huggingface-moon'), (b'X-Request-Id', b'Root=1-697eb778-381aa4f32466ff63659d8185;c4f8f0f3-62d7-4877-8696-88c4f9a30311'), (b'RateLimit', b'"resolvers";r=4997;t=219'), (b'RateLimit-Policy', b'"fixed window";"resolvers";q=5000;w=300'), (b'cross-origin-opener-policy', b'same-origin'), (b'Referrer-Policy', b'strict-origin-when-cross-origin'), (b'Access-Control-Max-Age', b'86400'), (b'Access-Control-Allow-Origin', b'https://huggingface.co'), (b'Vary', b'Origin'), (b'Access-Control-Expose-Headers', b'X-Repo-Commit,X-Request-Id,X-Error-Code,X-Error-Message,X-Total-Count,ETag,Link,Accept-Ranges,Content-Range,X-Linked-Size,X-Linked-ETag,X-Xet-Hash'), (b'X-Repo-Commit', b'3c879f39826c281e95690f02c7821c4de09afae7'), (b'Accept-Ranges', b'bytes'), (b'X-Hub-Cache', b'MISS'), (b'X-Error-Code', b'EntryNotFound'), (b'X-Error-Message', b'Entry not found'), (b'X-Cache', b'Error from cloudfront'), (b'Via', b'1.1 96514100085c5a3055b3debbca21d95c.cloudfront.net (CloudFront)'), (b'X-Amz-Cf-Pop', b'JFK50-P9'), (b'X-Amz-Cf-Id', b'uJAnqzD10Py0e6DINbH9DImJGaXTJ0LEp2RxIAP8CjUbHVUGVHk3Ng==')])
2026-01-31 21:16:24 [INFO] httpx - HTTP Request: HEAD https://huggingface.co/facebook/sam3/resolve/main/chat_template.jinja "HTTP/1.1 404 Not Found"
2026-01-31 21:16:24 [DEBUG] httpcore.http11 - receive_response_body.started request=<Request [b'HEAD']>
2026-01-31 21:16:24 [DEBUG] httpcore.http11 - receive_response_body.complete
2026-01-31 21:16:24 [DEBUG] httpcore.http11 - response_closed.started
2026-01-31 21:16:24 [DEBUG] httpcore.http11 - response_closed.complete
2026-01-31 21:16:24 [DEBUG] httpcore.http11 - send_request_headers.started request=<Request [b'HEAD']>
2026-01-31 21:16:24 [DEBUG] httpcore.http11 - send_request_headers.complete
2026-01-31 21:16:24 [DEBUG] httpcore.http11 - send_request_body.started request=<Request [b'HEAD']>
2026-01-31 21:16:24 [DEBUG] httpcore.http11 - send_request_body.complete
2026-01-31 21:16:24 [DEBUG] httpcore.http11 - receive_response_headers.started request=<Request [b'HEAD']>
2026-01-31 21:16:24 [DEBUG] httpcore.http11 - receive_response_headers.complete return_value=(b'HTTP/1.1', 404, b'Not Found', [(b'Content-Type', b'text/plain; charset=utf-8'), (b'Content-Length', b'15'), (b'Connection', b'keep-alive'), (b'Date', b'Sun, 01 Feb 2026 02:16:24 GMT'), (b'ETag', b'W/"f-mY2VvLxuxB7KhsoOdQTlMTccuAQ"'), (b'X-Powered-By', b'huggingface-moon'), (b'X-Request-Id', b'Root=1-697eb778-23b28a8256ad7e920fd386a9;c93fbf3f-1a58-4999-854b-72df5e78b17e'), (b'RateLimit', b'"resolvers";r=4996;t=219'), (b'RateLimit-Policy', b'"fixed window";"resolvers";q=5000;w=300'), (b'cross-origin-opener-policy', b'same-origin'), (b'Referrer-Policy', b'strict-origin-when-cross-origin'), (b'Access-Control-Max-Age', b'86400'), (b'Access-Control-Allow-Origin', b'https://huggingface.co'), (b'Vary', b'Origin'), (b'Access-Control-Expose-Headers', b'X-Repo-Commit,X-Request-Id,X-Error-Code,X-Error-Message,X-Total-Count,ETag,Link,Accept-Ranges,Content-Range,X-Linked-Size,X-Linked-ETag,X-Xet-Hash'), (b'X-Repo-Commit', b'3c879f39826c281e95690f02c7821c4de09afae7'), (b'Accept-Ranges', b'bytes'), (b'X-Hub-Cache', b'MISS'), (b'X-Error-Code', b'EntryNotFound'), (b'X-Error-Message', b'Entry not found'), (b'X-Cache', b'Error from cloudfront'), (b'Via', b'1.1 96514100085c5a3055b3debbca21d95c.cloudfront.net (CloudFront)'), (b'X-Amz-Cf-Pop', b'JFK50-P9'), (b'X-Amz-Cf-Id', b'qb_9at8noTqzK3CUKZ-mCAv9VOWhNRZHUoN7PUhw8M2PJgxmFBJz7Q==')])
2026-01-31 21:16:24 [INFO] httpx - HTTP Request: HEAD https://huggingface.co/facebook/sam3/resolve/main/audio_tokenizer_config.json "HTTP/1.1 404 Not Found"
2026-01-31 21:16:24 [DEBUG] httpcore.http11 - receive_response_body.started request=<Request [b'HEAD']>
2026-01-31 21:16:24 [DEBUG] httpcore.http11 - receive_response_body.complete
2026-01-31 21:16:24 [DEBUG] httpcore.http11 - response_closed.started
2026-01-31 21:16:24 [DEBUG] httpcore.http11 - response_closed.complete
2026-01-31 21:16:24 [DEBUG] httpcore.http11 - send_request_headers.started request=<Request [b'HEAD']>
2026-01-31 21:16:24 [DEBUG] httpcore.http11 - send_request_headers.complete
2026-01-31 21:16:24 [DEBUG] httpcore.http11 - send_request_body.started request=<Request [b'HEAD']>
2026-01-31 21:16:24 [DEBUG] httpcore.http11 - send_request_body.complete
2026-01-31 21:16:24 [DEBUG] httpcore.http11 - receive_response_headers.started request=<Request [b'HEAD']>
2026-01-31 21:16:24 [DEBUG] httpcore.http11 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Content-Type', b'text/plain; charset=utf-8'), (b'Content-Length', b'1712'), (b'Connection', b'keep-alive'), (b'Date', b'Sun, 01 Feb 2026 02:16:24 GMT'), (b'ETag', b'"9d3bd6df8a54852cd56087a3ae019cce051de2b2"'), (b'X-Powered-By', b'huggingface-moon'), (b'X-Request-Id', b'Root=1-697eb778-3981f84e2c01aa5915e224df;6ecb3857-7701-495e-9267-f0ab297e6a7e'), (b'RateLimit', b'"resolvers";r=4995;t=219'), (b'RateLimit-Policy', b'"fixed window";"resolvers";q=5000;w=300'), (b'cross-origin-opener-policy', b'same-origin'), (b'Referrer-Policy', b'strict-origin-when-cross-origin'), (b'Access-Control-Max-Age', b'86400'), (b'Access-Control-Allow-Origin', b'https://huggingface.co'), (b'Vary', b'Origin'), (b'Access-Control-Expose-Headers', b'X-Repo-Commit,X-Request-Id,X-Error-Code,X-Error-Message,X-Total-Count,ETag,Link,Accept-Ranges,Content-Range,X-Linked-Size,X-Linked-ETag,X-Xet-Hash'), (b'X-Repo-Commit', b'3c879f39826c281e95690f02c7821c4de09afae7'), (b'Accept-Ranges', b'bytes'), (b'X-Hub-Cache', b'HIT'), (b'Content-Disposition', b'inline; filename*=UTF-8\'\'processor_config.json; filename="processor_config.json";'), (b'Content-Security-Policy', b"default-src 'none'; sandbox"), (b'X-Cache', b'Miss from cloudfront'), (b'Via', b'1.1 96514100085c5a3055b3debbca21d95c.cloudfront.net (CloudFront)'), (b'X-Amz-Cf-Pop', b'JFK50-P9'), (b'X-Amz-Cf-Id', b'SkBFGQOiHB_WBRmpT3GD8Sffgn4L_MlNDL3NVTGgQ5JiUWERhV80aQ==')])
2026-01-31 21:16:24 [INFO] httpx - HTTP Request: HEAD https://huggingface.co/facebook/sam3/resolve/main/processor_config.json "HTTP/1.1 200 OK"
2026-01-31 21:16:24 [DEBUG] httpcore.http11 - receive_response_body.started request=<Request [b'HEAD']>
2026-01-31 21:16:24 [DEBUG] httpcore.http11 - receive_response_body.complete
2026-01-31 21:16:24 [DEBUG] httpcore.http11 - response_closed.started
2026-01-31 21:16:24 [DEBUG] httpcore.http11 - response_closed.complete
2026-01-31 21:16:24 [DEBUG] httpcore.http11 - send_request_headers.started request=<Request [b'HEAD']>
2026-01-31 21:16:24 [DEBUG] httpcore.http11 - send_request_headers.complete
2026-01-31 21:16:24 [DEBUG] httpcore.http11 - send_request_body.started request=<Request [b'HEAD']>
2026-01-31 21:16:24 [DEBUG] httpcore.http11 - send_request_body.complete
2026-01-31 21:16:24 [DEBUG] httpcore.http11 - receive_response_headers.started request=<Request [b'HEAD']>
2026-01-31 21:16:24 [DEBUG] httpcore.http11 - receive_response_headers.complete return_value=(b'HTTP/1.1', 404, b'Not Found', [(b'Content-Type', b'text/plain; charset=utf-8'), (b'Content-Length', b'15'), (b'Connection', b'keep-alive'), (b'Date', b'Sun, 01 Feb 2026 02:16:24 GMT'), (b'ETag', b'W/"f-mY2VvLxuxB7KhsoOdQTlMTccuAQ"'), (b'X-Powered-By', b'huggingface-moon'), (b'X-Request-Id', b'Root=1-697eb778-43dc26206b7b58190b6f9690;c3d022d8-0ba4-4e1e-b761-8a64bed4140b'), (b'RateLimit', b'"resolvers";r=4994;t=219'), (b'RateLimit-Policy', b'"fixed window";"resolvers";q=5000;w=300'), (b'cross-origin-opener-policy', b'same-origin'), (b'Referrer-Policy', b'strict-origin-when-cross-origin'), (b'Access-Control-Max-Age', b'86400'), (b'Access-Control-Allow-Origin', b'https://huggingface.co'), (b'Vary', b'Origin'), (b'Access-Control-Expose-Headers', b'X-Repo-Commit,X-Request-Id,X-Error-Code,X-Error-Message,X-Total-Count,ETag,Link,Accept-Ranges,Content-Range,X-Linked-Size,X-Linked-ETag,X-Xet-Hash'), (b'X-Repo-Commit', b'3c879f39826c281e95690f02c7821c4de09afae7'), (b'Accept-Ranges', b'bytes'), (b'X-Hub-Cache', b'MISS'), (b'X-Error-Code', b'EntryNotFound'), (b'X-Error-Message', b'Entry not found'), (b'X-Cache', b'Error from cloudfront'), (b'Via', b'1.1 96514100085c5a3055b3debbca21d95c.cloudfront.net (CloudFront)'), (b'X-Amz-Cf-Pop', b'JFK50-P9'), (b'X-Amz-Cf-Id', b'Q5JtSTlG0SAW5GZsGib8DAdW1fAUNfwhdDsCpWWkTbGccQUuOmHL7g==')])
2026-01-31 21:16:24 [INFO] httpx - HTTP Request: HEAD https://huggingface.co/facebook/sam3/resolve/main/preprocessor_config.json "HTTP/1.1 404 Not Found"
2026-01-31 21:16:24 [DEBUG] httpcore.http11 - receive_response_body.started request=<Request [b'HEAD']>
2026-01-31 21:16:24 [DEBUG] httpcore.http11 - receive_response_body.complete
2026-01-31 21:16:24 [DEBUG] httpcore.http11 - response_closed.started
2026-01-31 21:16:24 [DEBUG] httpcore.http11 - response_closed.complete
2026-01-31 21:16:24 [DEBUG] httpcore.http11 - send_request_headers.started request=<Request [b'HEAD']>
2026-01-31 21:16:24 [DEBUG] httpcore.http11 - send_request_headers.complete
2026-01-31 21:16:24 [DEBUG] httpcore.http11 - send_request_body.started request=<Request [b'HEAD']>
2026-01-31 21:16:24 [DEBUG] httpcore.http11 - send_request_body.complete
2026-01-31 21:16:24 [DEBUG] httpcore.http11 - receive_response_headers.started request=<Request [b'HEAD']>
2026-01-31 21:16:24 [DEBUG] httpcore.http11 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Content-Type', b'text/plain; charset=utf-8'), (b'Content-Length', b'1712'), (b'Connection', b'keep-alive'), (b'Date', b'Sun, 01 Feb 2026 02:16:24 GMT'), (b'ETag', b'"9d3bd6df8a54852cd56087a3ae019cce051de2b2"'), (b'X-Powered-By', b'huggingface-moon'), (b'X-Request-Id', b'Root=1-697eb778-3acbbc2349b77afa1ed85ddf;101af7a4-8886-4930-98b1-3b2f8a19af91'), (b'RateLimit', b'"resolvers";r=4993;t=219'), (b'RateLimit-Policy', b'"fixed window";"resolvers";q=5000;w=300'), (b'cross-origin-opener-policy', b'same-origin'), (b'Referrer-Policy', b'strict-origin-when-cross-origin'), (b'Access-Control-Max-Age', b'86400'), (b'Access-Control-Allow-Origin', b'https://huggingface.co'), (b'Vary', b'Origin'), (b'Access-Control-Expose-Headers', b'X-Repo-Commit,X-Request-Id,X-Error-Code,X-Error-Message,X-Total-Count,ETag,Link,Accept-Ranges,Content-Range,X-Linked-Size,X-Linked-ETag,X-Xet-Hash'), (b'X-Repo-Commit', b'3c879f39826c281e95690f02c7821c4de09afae7'), (b'Accept-Ranges', b'bytes'), (b'X-Hub-Cache', b'HIT'), (b'Content-Disposition', b'inline; filename*=UTF-8\'\'processor_config.json; filename="processor_config.json";'), (b'Content-Security-Policy', b"default-src 'none'; sandbox"), (b'X-Cache', b'Miss from cloudfront'), (b'Via', b'1.1 96514100085c5a3055b3debbca21d95c.cloudfront.net (CloudFront)'), (b'X-Amz-Cf-Pop', b'JFK50-P9'), (b'X-Amz-Cf-Id', b'vOBqyerUYnOFnbx2MqC1a_0JXtruZ5XCsK9qsT4nm1IwevXYzziVgA==')])
2026-01-31 21:16:24 [INFO] httpx - HTTP Request: HEAD https://huggingface.co/facebook/sam3/resolve/main/processor_config.json "HTTP/1.1 200 OK"
2026-01-31 21:16:24 [DEBUG] httpcore.http11 - receive_response_body.started request=<Request [b'HEAD']>
2026-01-31 21:16:24 [DEBUG] httpcore.http11 - receive_response_body.complete
2026-01-31 21:16:24 [DEBUG] httpcore.http11 - response_closed.started
2026-01-31 21:16:24 [DEBUG] httpcore.http11 - response_closed.complete
2026-01-31 21:16:24 [DEBUG] httpcore.http11 - send_request_headers.started request=<Request [b'HEAD']>
2026-01-31 21:16:24 [DEBUG] httpcore.http11 - send_request_headers.complete
2026-01-31 21:16:24 [DEBUG] httpcore.http11 - send_request_body.started request=<Request [b'HEAD']>
2026-01-31 21:16:24 [DEBUG] httpcore.http11 - send_request_body.complete
2026-01-31 21:16:24 [DEBUG] httpcore.http11 - receive_response_headers.started request=<Request [b'HEAD']>
2026-01-31 21:16:24 [DEBUG] httpcore.http11 - receive_response_headers.complete return_value=(b'HTTP/1.1', 404, b'Not Found', [(b'Content-Type', b'text/plain; charset=utf-8'), (b'Content-Length', b'15'), (b'Connection', b'keep-alive'), (b'Date', b'Sun, 01 Feb 2026 02:16:24 GMT'), (b'ETag', b'W/"f-mY2VvLxuxB7KhsoOdQTlMTccuAQ"'), (b'X-Powered-By', b'huggingface-moon'), (b'X-Request-Id', b'Root=1-697eb778-4e2874647bc2c08d5fa7b83d;c246449f-e6a6-482a-8744-9124bb8b9181'), (b'RateLimit', b'"resolvers";r=4992;t=219'), (b'RateLimit-Policy', b'"fixed window";"resolvers";q=5000;w=300'), (b'cross-origin-opener-policy', b'same-origin'), (b'Referrer-Policy', b'strict-origin-when-cross-origin'), (b'Access-Control-Max-Age', b'86400'), (b'Access-Control-Allow-Origin', b'https://huggingface.co'), (b'Vary', b'Origin'), (b'Access-Control-Expose-Headers', b'X-Repo-Commit,X-Request-Id,X-Error-Code,X-Error-Message,X-Total-Count,ETag,Link,Accept-Ranges,Content-Range,X-Linked-Size,X-Linked-ETag,X-Xet-Hash'), (b'X-Repo-Commit', b'3c879f39826c281e95690f02c7821c4de09afae7'), (b'Accept-Ranges', b'bytes'), (b'X-Hub-Cache', b'MISS'), (b'X-Error-Code', b'EntryNotFound'), (b'X-Error-Message', b'Entry not found'), (b'X-Cache', b'Error from cloudfront'), (b'Via', b'1.1 96514100085c5a3055b3debbca21d95c.cloudfront.net (CloudFront)'), (b'X-Amz-Cf-Pop', b'JFK50-P9'), (b'X-Amz-Cf-Id', b'FmVGZ8ajvxhcqfEnQEn2-g73LWOazt9CY81LWneQo-itBZLVMmr-pA==')])
2026-01-31 21:16:24 [INFO] httpx - HTTP Request: HEAD https://huggingface.co/facebook/sam3/resolve/main/preprocessor_config.json "HTTP/1.1 404 Not Found"
2026-01-31 21:16:24 [DEBUG] httpcore.http11 - receive_response_body.started request=<Request [b'HEAD']>
2026-01-31 21:16:24 [DEBUG] httpcore.http11 - receive_response_body.complete
2026-01-31 21:16:24 [DEBUG] httpcore.http11 - response_closed.started
2026-01-31 21:16:24 [DEBUG] httpcore.http11 - response_closed.complete
2026-01-31 21:16:24 [DEBUG] httpcore.http11 - send_request_headers.started request=<Request [b'HEAD']>
2026-01-31 21:16:24 [DEBUG] httpcore.http11 - send_request_headers.complete
2026-01-31 21:16:24 [DEBUG] httpcore.http11 - send_request_body.started request=<Request [b'HEAD']>
2026-01-31 21:16:24 [DEBUG] httpcore.http11 - send_request_body.complete
2026-01-31 21:16:24 [DEBUG] httpcore.http11 - receive_response_headers.started request=<Request [b'HEAD']>
2026-01-31 21:16:25 [DEBUG] httpcore.http11 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Content-Type', b'text/plain; charset=utf-8'), (b'Content-Length', b'25843'), (b'Connection', b'keep-alive'), (b'Date', b'Sun, 01 Feb 2026 02:16:25 GMT'), (b'ETag', b'"3e600e765b0f1b4c52680aed9ad242c9a90f7ed1"'), (b'X-Powered-By', b'huggingface-moon'), (b'X-Request-Id', b'Root=1-697eb778-5cd03519208d89a7561ed78a;6303e60f-066e-4402-bf44-1a4558a53381'), (b'RateLimit', b'"resolvers";r=4991;t=219'), (b'RateLimit-Policy', b'"fixed window";"resolvers";q=5000;w=300'), (b'cross-origin-opener-policy', b'same-origin'), (b'Referrer-Policy', b'strict-origin-when-cross-origin'), (b'Access-Control-Max-Age', b'86400'), (b'Access-Control-Allow-Origin', b'https://huggingface.co'), (b'Vary', b'Origin'), (b'Access-Control-Expose-Headers', b'X-Repo-Commit,X-Request-Id,X-Error-Code,X-Error-Message,X-Total-Count,ETag,Link,Accept-Ranges,Content-Range,X-Linked-Size,X-Linked-ETag,X-Xet-Hash'), (b'X-Repo-Commit', b'3c879f39826c281e95690f02c7821c4de09afae7'), (b'Accept-Ranges', b'bytes'), (b'X-Hub-Cache', b'HIT'), (b'Content-Disposition', b'inline; filename*=UTF-8\'\'config.json; filename="config.json";'), (b'Content-Security-Policy', b"default-src 'none'; sandbox"), (b'X-Cache', b'Miss from cloudfront'), (b'Via', b'1.1 96514100085c5a3055b3debbca21d95c.cloudfront.net (CloudFront)'), (b'X-Amz-Cf-Pop', b'JFK50-P9'), (b'X-Amz-Cf-Id', b'RtyJs4IHFzMlzaNN-BqRhyAfuZtyL4UbtvfN3QYKOZTyIbJIaLg2qA==')])
2026-01-31 21:16:25 [INFO] httpx - HTTP Request: HEAD https://huggingface.co/facebook/sam3/resolve/main/config.json "HTTP/1.1 200 OK"
2026-01-31 21:16:25 [DEBUG] httpcore.http11 - receive_response_body.started request=<Request [b'HEAD']>
2026-01-31 21:16:25 [DEBUG] httpcore.http11 - receive_response_body.complete
2026-01-31 21:16:25 [DEBUG] httpcore.http11 - response_closed.started
2026-01-31 21:16:25 [DEBUG] httpcore.http11 - response_closed.complete
2026-01-31 21:16:25 [DEBUG] httpcore.http11 - send_request_headers.started request=<Request [b'HEAD']>
2026-01-31 21:16:25 [DEBUG] httpcore.http11 - send_request_headers.complete
2026-01-31 21:16:25 [DEBUG] httpcore.http11 - send_request_body.started request=<Request [b'HEAD']>
2026-01-31 21:16:25 [DEBUG] httpcore.http11 - send_request_body.complete
2026-01-31 21:16:25 [DEBUG] httpcore.http11 - receive_response_headers.started request=<Request [b'HEAD']>
2026-01-31 21:16:25 [DEBUG] httpcore.http11 - receive_response_headers.complete return_value=(b'HTTP/1.1', 302, b'Found', [(b'Content-Type', b'text/plain; charset=utf-8'), (b'Content-Length', b'1335'), (b'Connection', b'keep-alive'), (b'Date', b'Sun, 01 Feb 2026 02:16:25 GMT'), (b'Location', b'https://cas-bridge.xethub.hf.co/xet-bridge-us/690d80fc9f252aa897a1dc6d/1ebb91a10cf694d5b65a18dda24bac6445f6e74ecae2809f9c19df49b58fed03?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=cas%2F20260201%2Fus-east-1%2Fs3%2Faws4_request&X-Amz-Date=20260201T020728Z&X-Amz-Expires=3600&X-Amz-Signature=d692e79201e6d67012d5d1194d9d912a488457c6001bd99f8387306a8e303c82&X-Amz-SignedHeaders=host&X-Xet-Cas-Uid=6525708de0094b7bf20813a9&response-content-disposition=inline%3B+filename*%3DUTF-8%27%27model.safetensors%3B+filename%3D%22model.safetensors%22%3B&x-id=GetObject&Expires=1769915248&Policy=eyJTdGF0ZW1lbnQiOlt7IkNvbmRpdGlvbiI6eyJEYXRlTGVzc1RoYW4iOnsiQVdTOkVwb2NoVGltZSI6MTc2OTkxNTI0OH19LCJSZXNvdXJjZSI6Imh0dHBzOi8vY2FzLWJyaWRnZS54ZXRodWIuaGYuY28veGV0LWJyaWRnZS11cy82OTBkODBmYzlmMjUyYWE4OTdhMWRjNmQvMWViYjkxYTEwY2Y2OTRkNWI2NWExOGRkYTI0YmFjNjQ0NWY2ZTc0ZWNhZTI4MDlmOWMxOWRmNDliNThmZWQwMyoifV19&Signature=n15r5iQlhpoR327BvcroeOrasXbaiNe60s8paQ-Ajextc5aeywZdvaJIv-SB5OTQZpWyy27rFu1PndZp4-bpA74X5frPs7OMlIiYBSfqHakNUtmRMm%7Erb-bTQCJNsb3p7RoKfULlryuZncx0s0kAV-uQB8Le1LLbhh1j%7E77eUz9RbCF2PEIaMTVH5jWb--j7izwaTIPGYMMfSN4ma5f4eeYPs0Cz34XWrF5tamX3dopZATTJYwYsKcVSAhk5MZkKZhGQYmRdAGLBhzrK%7E2Ujoq8mNgWUgjL75mA9yLrOgkms78LFpRCuI8XrObh8tjnihCEJVuAbZ2j-9cbMihKXFg__&Key-Pair-Id=K2L8F4GPSG1IFC'), (b'X-Powered-By', b'huggingface-moon'), (b'X-Request-Id', b'Root=1-697eb779-579aacfc718b6fdf72815096;0756d833-b223-4f6e-82e5-bbabae69681b'), (b'RateLimit', b'"resolvers";r=4990;t=218'), (b'RateLimit-Policy', b'"fixed window";"resolvers";q=5000;w=300'), (b'cross-origin-opener-policy', b'same-origin'), (b'Referrer-Policy', b'strict-origin-when-cross-origin'), (b'Access-Control-Max-Age', b'86400'), (b'Access-Control-Allow-Origin', b'https://huggingface.co'), (b'Vary', b'Origin, Accept'), (b'Access-Control-Expose-Headers', b'X-Repo-Commit,X-Request-Id,X-Error-Code,X-Error-Message,X-Total-Count,ETag,Link,Accept-Ranges,Content-Range,X-Linked-Size,X-Linked-ETag,X-Xet-Hash'), (b'X-Repo-Commit', b'3c879f39826c281e95690f02c7821c4de09afae7'), (b'Accept-Ranges', b'bytes'), (b'X-Hub-Cache', b'HIT'), (b'X-Linked-Size', b'3439938512'), (b'X-Linked-ETag', b'"6d06f0a5f84e435071fe6603e61d0b4cc7b40e0d39d487cfd4d67d8cc11cc14a"'), (b'X-Xet-Hash', b'1ebb91a10cf694d5b65a18dda24bac6445f6e74ecae2809f9c19df49b58fed03'), (b'Link', b'<https://huggingface.co/api/models/facebook/sam3/xet-read-token/3c879f39826c281e95690f02c7821c4de09afae7>; rel="xet-auth", <https://cas-server.xethub.hf.co/v1/reconstructions/1ebb91a10cf694d5b65a18dda24bac6445f6e74ecae2809f9c19df49b58fed03>; rel="xet-reconstruction-info"'), (b'X-Cache', b'Miss from cloudfront'), (b'Via', b'1.1 96514100085c5a3055b3debbca21d95c.cloudfront.net (CloudFront)'), (b'X-Amz-Cf-Pop', b'JFK50-P9'), (b'X-Amz-Cf-Id', b'lqanQPfcR3bZawes0aIt2rnTaPyzeX2CQs15Y7FGICG3bEo3KKHMYQ==')])
2026-01-31 21:16:25 [INFO] httpx - HTTP Request: HEAD https://huggingface.co/facebook/sam3/resolve/main/model.safetensors "HTTP/1.1 302 Found"
2026-01-31 21:16:25 [DEBUG] httpcore.http11 - receive_response_body.started request=<Request [b'HEAD']>
2026-01-31 21:16:25 [DEBUG] httpcore.http11 - receive_response_body.complete
2026-01-31 21:16:25 [DEBUG] httpcore.http11 - response_closed.started
2026-01-31 21:16:25 [DEBUG] httpcore.http11 - response_closed.complete
2026-01-31 21:16:36 [INFO] __main__ - SAM3 tracker model loaded successfully.
2026-01-31 21:16:36 [INFO] __main__ - Running segmentation pipeline...
2026-01-31 21:16:36 [INFO] __main__ - Image preprocessed. Shape: (1024, 1024)
2026-01-31 21:16:36 [INFO] __main__ - Tiling enabled. Creating tile grid...
2026-01-31 21:16:36 [INFO] __main__ - Created 25 tiles with padding bottom=0, right=0
2026-01-31 21:16:36 [DEBUG] __main__ - Processing tile 1/25: (0, 0) to (256, 256)
2026-01-31 21:16:37 [DEBUG] __main__ -   Tile 1: Found 105 candidate points
2026-01-31 21:16:37 [DEBUG] httpcore.connection - close.started
2026-01-31 21:16:37 [DEBUG] httpcore.connection - close.complete
